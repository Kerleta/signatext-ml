<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Riwayat Terjemahan - SignaText</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
      .history-item {
        border: 1px solid #ccc;
        border-radius: 8px;
        padding: 16px;
        margin-bottom: 16px;
      }
    </style>
  </head>
  <body class="bg-gray-100">
    <!-- Include Navbar -->
    <div id="navbar"></div>

    <div class="container mx-auto p-4">
      <h2 class="text-2xl font-bold mb-4 text-center">Riwayat Terjemahan</h2>
      <div id="history-list" class="space-y-4">
        <!-- History items will be populated here -->
      </div>
    </div>

    <script>
      // Fungsi untuk memeriksa status login
      function checkAuthStatus() {
        const token = localStorage.getItem("authToken");
        if (!token) {
          alert("Anda harus login untuk melihat riwayat terjemahan.");
          window.location.href = "/login.html";
          return;
        }
      }

      // Fetch history data
      async function fetchHistory() {
        try {
          const response = await fetch("/api/history", {
            headers: {
              Authorization: `Bearer ${localStorage.getItem("authToken")}`,
            },
          });

          if (!response.ok) {
            throw new Error(await response.text());
          }

          const data = await response.json();
          const historyList = document.getElementById("history-list");
          historyList.innerHTML = "";

          data.forEach((item) => {
            const historyItem = document.createElement("div");
            historyItem.className = "history-item";
            historyItem.innerHTML = `
            <p><strong>${item.translation}</strong></p>
            <p>${item.timestamp}</p>
          `;
            historyList.appendChild(historyItem);
          });
        } catch (error) {
          alert("Gagal memuat riwayat terjemahan.");
          console.error(error);
        }
      }

      document.addEventListener("DOMContentLoaded", () => {
        // Include Navbar
        fetch("/navbar.html")
          .then((response) => response.text())
          .then((html) => {
            document.getElementById("navbar").innerHTML = html;
            checkAuthStatus();
            fetchHistory();
          });
      });
    </script>
  </body>
</html>
